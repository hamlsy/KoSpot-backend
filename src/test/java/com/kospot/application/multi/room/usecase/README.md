# JoinGameRoomUseCase í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°œìš”

í˜„ì¬ `JoinGameRoomUseCase`ì˜ ì„¤ê³„ê°€ ì˜¬ë°”ë¥´ê²Œ "ì‘ë™"í•˜ëŠ”ì§€ ê²€ì¦í•˜ëŠ” í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì½”ë“œì…ë‹ˆë‹¤.  
ì„±ëŠ¥ ìµœì í™”ëŠ” ë‚˜ì¤‘ì— ì§„í–‰í•˜ë˜, **ê¸°ë³¸ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ í˜„ì¬ ì„¤ê³„ì˜ íŠ¹ì„±**ì„ ëª…í™•íˆ íŒŒì•…í•©ë‹ˆë‹¤.

## ğŸ§ª í…ŒìŠ¤íŠ¸ êµ¬ì„±

### 1. JoinGameRoomUseCaseTest.java
**ê¸°ë³¸ ê¸°ëŠ¥ ê²€ì¦ ë° í†µí•© í…ŒìŠ¤íŠ¸**

#### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:
- âœ… **ì •ìƒì ì¸ ê²Œì„ë°© ì°¸ê°€ í”Œë¡œìš°** - ì „ì²´ ì²˜ë¦¬ ê³¼ì • ê²€ì¦
- âœ… **ì´ë²¤íŠ¸ ì²˜ë¦¬ í›„ Redis ìƒíƒœ ê²€ì¦** - ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë™ì‘ í™•ì¸
- âœ… **ê²Œì„ë°© ìµœëŒ€ ì¸ì› ì´ˆê³¼ ì‹œ ì˜ˆì™¸ ë°œìƒ** - ìš©ëŸ‰ ì œí•œ ë¡œì§ ê²€ì¦
- âœ… **ë¹„ë°€ë²ˆí˜¸ ë°© ì°¸ê°€** - ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ë¡œì§ í™•ì¸
- âœ… **ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ ì˜ˆì™¸ ì²˜ë¦¬** - ë³´ì•ˆ ê²€ì¦
- âœ… **ì¤‘ë³µ ì°¸ê°€ ë°©ì§€** - í”Œë ˆì´ì–´ ìƒíƒœ ê´€ë¦¬ ê²€ì¦
- âœ… **ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²Œì„ë°© ì˜ˆì™¸ ì²˜ë¦¬** - ë°ì´í„° ìœ íš¨ì„± ê²€ì¦
- âœ… **ê²Œì„ ì§„í–‰ ì¤‘ ì°¸ê°€ ë°©ì§€** - ê²Œì„ ìƒíƒœ ê²€ì¦
- âœ… **Redis-DB ê°„ ë°ì´í„° ì¼ê´€ì„±** - ë°ì´í„° ì €ì¥ì†Œ ê°„ ë™ê¸°í™” í™•ì¸

### 2. JoinGameRoomConcurrencyTest.java
**ë™ì‹œì„± ë° ì„±ëŠ¥ íŠ¹ì„± ë¶„ì„**

#### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:
- ğŸ” **Race Condition ë°œìƒ í™•ì¸** - í˜„ì¬ ì„¤ê³„ì˜ ë™ì‹œì„± ì´ìŠˆ ëª…í™•í™”
- ğŸ”„ **ìˆœì°¨ì  ì°¸ê°€ í…ŒìŠ¤íŠ¸** - ì •ìƒ ì¼€ì´ìŠ¤ì—ì„œì˜ ë™ì‘ ê²€ì¦
- ğŸ“ˆ **ì„±ëŠ¥ ê¸°ì¤€ ì¸¡ì •** - í–¥í›„ ìµœì í™” ì‘ì—…ì˜ ë¹„êµ ê¸°ì¤€ì  ì œê³µ
- ğŸ” **ë°ì´í„° ì¼ê´€ì„± ê²€ì¦** - DBì™€ Redis ê°„ ë™ê¸°í™” ìƒíƒœ ë¶„ì„

## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•

### ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
# Gradle ì‚¬ìš©
./gradlew test --tests "com.kospot.application.multi.room.usecase.*"

# ë˜ëŠ” IDEì—ì„œ íŒ¨í‚¤ì§€ ë‹¨ìœ„ ì‹¤í–‰
```

### ê°œë³„ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‹¤í–‰
```bash
# ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë§Œ
./gradlew test --tests "com.kospot.application.multi.room.usecase.JoinGameRoomUseCaseTest"

# ë™ì‹œì„± í…ŒìŠ¤íŠ¸ë§Œ
./gradlew test --tests "com.kospot.application.multi.room.usecase.JoinGameRoomConcurrencyTest"
```

## ğŸ“Š ì˜ˆìƒ í…ŒìŠ¤íŠ¸ ê²°ê³¼

### âœ… í†µê³¼í•´ì•¼ í•˜ëŠ” í…ŒìŠ¤íŠ¸
- ëª¨ë“  ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (JoinGameRoomUseCaseTest)
- ìˆœì°¨ì  ì°¸ê°€ í…ŒìŠ¤íŠ¸
- ì„±ëŠ¥ ê¸°ì¤€ í…ŒìŠ¤íŠ¸ (í˜„ì¬ ì„±ëŠ¥ ìˆ˜ì¤€ì—ì„œ)

### âš ï¸ í˜„ì¬ ì„¤ê³„ì˜ í•œê³„ë¡œ ì¸í•œ ì˜ˆìƒ ì´ìŠˆ
1. **Race Condition í…ŒìŠ¤íŠ¸**ì—ì„œ ìµœëŒ€ ì¸ì› ì´ˆê³¼ ì°¸ê°€ ë°œìƒ ê°€ëŠ¥
2. **ë°ì´í„° ì¼ê´€ì„± í…ŒìŠ¤íŠ¸**ì—ì„œ DB-Redis ê°„ ë¶ˆì¼ì¹˜ ë°œìƒ ê°€ëŠ¥
3. **ë™ì‹œì„± í…ŒìŠ¤íŠ¸**ì—ì„œ ì˜ˆìƒë³´ë‹¤ ë§ì€ ì„±ê³µ ì¼€ì´ìŠ¤ ë°œìƒ ê°€ëŠ¥

> ğŸ“ **ì¤‘ìš”**: ìœ„ ì´ìŠˆë“¤ì€ **í˜„ì¬ ì„¤ê³„ì˜ íŠ¹ì„±**ì´ë©°, í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ê°€ ì•„ë‹™ë‹ˆë‹¤.  
> ì´í›„ ì„±ëŠ¥ ìµœì í™” ì‘ì—…ì—ì„œ í•´ê²°ë  ì˜ˆì •ì…ë‹ˆë‹¤.

## ğŸ”§ í…ŒìŠ¤íŠ¸ í™˜ê²½ ìš”êµ¬ì‚¬í•­

### í•„ìˆ˜ ì„¤ì •
- Spring Boot Test í™˜ê²½
- Redis (í…ŒìŠ¤íŠ¸ìš© - TestContainers ë˜ëŠ” ë¡œì»¬ Redis)
- H2 Database (ë˜ëŠ” í…ŒìŠ¤íŠ¸ìš© DB)

### ê¶Œì¥ ì„¤ì •
```properties
# application-test.properties
spring.datasource.url=jdbc:h2:mem:testdb
spring.jpa.hibernate.ddl-auto=create-drop
spring.data.redis.host=localhost
spring.data.redis.port=6379
logging.level.com.kospot=DEBUG
```

## ğŸ“ˆ ì„±ëŠ¥ ê¸°ì¤€ì 

### í˜„ì¬ ì¸¡ì • ê¸°ì¤€ (í–¥í›„ ìµœì í™” ë¹„êµìš©)
- **í‰ê·  ì²˜ë¦¬ ì‹œê°„**: 4ëª… ìˆœì°¨ ì°¸ê°€ ì‹œ < 5ì´ˆ
- **ìµœëŒ€ ì²˜ë¦¬ ì‹œê°„**: < 10ì´ˆ
- **ë™ì‹œì„± ì²˜ë¦¬**: 8ê°œ ìŠ¤ë ˆë“œ ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ê°€ëŠ¥

### í–¥í›„ ìµœì í™” ëª©í‘œ (ì°¸ê³ ìš©)
- **í‰ê·  ì²˜ë¦¬ ì‹œê°„**: < 500ms
- **ë™ì‹œì„± ì•ˆì •ì„±**: Race Condition ì™„ì „ í•´ê²°
- **ë°ì´í„° ì¼ê´€ì„±**: DB-Redis 100% ë™ê¸°í™”

## ğŸ¯ í…ŒìŠ¤íŠ¸ í™œìš© ë°©ë²•

### 1. ê°œë°œ ë‹¨ê³„
- **ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸**ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦
- **í†µí•© í…ŒìŠ¤íŠ¸**ë¡œ ì „ì²´ í”Œë¡œìš° í™•ì¸

### 2. ì½”ë“œ ë¦¬ë·° ë‹¨ê³„
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸
- ë™ì‹œì„± í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„

### 3. ì„±ëŠ¥ ìµœì í™” ì „
- **í˜„ì¬ ì„±ëŠ¥ ê¸°ì¤€ì ** ì¸¡ì • ë° ê¸°ë¡
- **ë¬¸ì œì  ëª…í™•í™”** ë° ê°œì„  ìš°ì„ ìˆœìœ„ ì„¤ì •

### 4. ì„±ëŠ¥ ìµœì í™” í›„
- **Before/After ë¹„êµ** ë¶„ì„
- **ë™ì‹œì„± ì´ìŠˆ í•´ê²°** ê²€ì¦
- **ë°ì´í„° ì¼ê´€ì„± ê°œì„ ** í™•ì¸

## ğŸ” ê²°ê³¼ ë¶„ì„ ê°€ì´ë“œ

### ì •ìƒ ë™ì‘ ì§€í‘œ
```
âœ… ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸: ì „ì²´ í†µê³¼
âœ… ìˆœì°¨ ì°¸ê°€: ì •í™•íˆ ìµœëŒ€ ì¸ì›ë§Œ ì„±ê³µ
âœ… ì˜ˆì™¸ ì²˜ë¦¬: ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì‹¤íŒ¨
âœ… ë°ì´í„° ì €ì¥: DBì— ì˜¬ë°”ë¥¸ ìƒíƒœ ì €ì¥
```

### í˜„ì¬ ì„¤ê³„ í•œê³„ ì§€í‘œ
```
âš ï¸ ë™ì‹œì„± í…ŒìŠ¤íŠ¸: ìµœëŒ€ ì¸ì› ì´ˆê³¼ ì°¸ê°€ ë°œìƒ
âš ï¸ ë°ì´í„° ì¼ê´€ì„±: DBì™€ Redis ê°„ ë¶ˆì¼ì¹˜
âš ï¸ Race Condition: ì˜ˆìƒë³´ë‹¤ ë§ì€ ì„±ê³µ ì¼€ì´ìŠ¤
```

### ì„±ëŠ¥ ë¶„ì„ í¬ì¸íŠ¸
```
ğŸ“Š ì‘ë‹µ ì‹œê°„ ë¶„í¬
ğŸ“Š ì²˜ë¦¬ëŸ‰ (TPS)
ğŸ“Š ì—ëŸ¬ìœ¨
ğŸ“Š ë°ì´í„° ì •í•©ì„± ë¹„ìœ¨
```

---

**ğŸ’¡ Tip**: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ ë¡œê·¸ ë ˆë²¨ì„ DEBUGë¡œ ì„¤ì •í•˜ë©´ ë” ìì„¸í•œ ì²˜ë¦¬ ê³¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
